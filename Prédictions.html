<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Pr√©dictions</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .encadre-background {
            background-color: #f0f8ff;
            padding: 30px 0;
        }

        .encadre-texte {
            font-family: 'Segoe UI', sans-serif;
            font-size: 1.1em;
            width: 60%;
            margin: 0 auto;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0);
            border-radius: 8px;
        }

        table {
            width: 80%;
            margin: auto;
            border-collapse: collapse;
            font-family: 'Segoe UI', sans-serif;
        }

        th, td {
            padding: 10px;
            text-align: center;
            border: 1px solid #aaa;
        }

        /* üéØ Largeurs personnalis√©es des colonnes */
        .col1 {
            width: 30%;
        }

        .col2 {
            width: 40%;
        }

        .col3 {
            width: 30%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        thead {
            background-color: #4a90e2;
            color: white;
        }

        #yearSelect {
            font-size: 1em;
            padding: 6px;
            margin: 10px auto 20px auto;
        }

        #tableContainer {
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div id="header-placeholder"></div>

    <main>
        <section>
            <div class="encadre-texte">
                √Ä chaque d√©but d'ann√©e les strat√©gistes des grandes banques et fonds d'investissement d√©voilent leurs pr√©dictions sur le S&P 500 pour l'ann√©e √† venir. Ils sont pay√©s des millions par ann√©e et poss√®dent des mod√®les √©conom√©triques tr√®s avanc√©s. Ils devraient √™tre bons, n'est-ce pas‚ÄØ? Pourtant ann√©e apr√®s ann√©e ils sont toujours √† l'emploi de leur firme √† attendre leur ch√®que aux 2 semaines. Charlatants ou experts? Voyez par vous-m√™mes‚ÄØ!
            </div>

            <h2 style="text-align:center;">Pr√©dictions du S&P 500</h2>

           <div class="year-selector">
    <label for="yearSelect">üìÖ Ann√©e :</label>
    <select id="yearSelect" onchange="displayTable(this.value)">
        <option value="">-- S√©lectionner --</option>
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
        <option value="2023">2023</option>
        <option value="2024">2024</option>
    </select>
</div>

           
            <div id="chartContainer" style="max-width: 960px; margin: auto;">
  <canvas id="chartCanvas" height="140"></canvas>
</div>
        </section>
    </main>

    <footer style="text-align:center; margin-top: 40px;">
        <p>&copy; 2025 - Finoza</p>
    </footer>

    <script>
        fetch('header.html')
            .then(res => res.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
            })
            .catch(error => console.error('Erreur de chargement du header‚ÄØ:', error));

      
    </script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3"></script>
<script>
  const chartDataByYear = {
    "2020": {
      real: 3756,
      institutions: ["Goldman Sachs", "JP Morgan", "Bank of America", "Morgan Stanley", "UBS", "Wells Fargo", "Barclays", "RBC", "Deutsche Bank", "Credit Suisse", "BMO", "Oppenheimer"],
      previsions: [3400, 3400, 3300, 3000, 3000, 3300, 3300, 3350, 3250, 3425, 3400, 3500]
    },
    // Tu peux ajouter ici "2021", "2022", etc. avec des objets similaires
  };

  const ctx = document.getElementById('chartCanvas').getContext('2d');
  let chartInstance;

  function displayTable(year) {
    const data = chartDataByYear[year];
    if (!data) {
      if (chartInstance) chartInstance.destroy();
      return;
    }

    const { institutions, previsions, real } = data;
    const ecarts = previsions.map(p => Math.max(real - p, 0));
    const base = previsions.map(p => Math.min(p, real));

    if (chartInstance) chartInstance.destroy();

    chartInstance = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: institutions,
        datasets: [
          {
            label: 'Pr√©vision',
            data: base,
            backgroundColor: 'rgba(54, 162, 235, 0.8)',
            stack: 'grp'
          },
          {
            label: '√âcart vers R√©alit√©',
            data: ecarts,
            backgroundColor: 'rgba(255, 99, 132, 0.6)',
            stack: 'grp'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          title: {
            display: true,
            text: `S&P 500 ‚Äì ${year} : Pr√©visions vs R√©alit√© (${real} pts)`,
            font: { size: 18 }
          },
          legend: { position: 'bottom' }
        },
        scales: {
          x: { stacked: true },
          y: {
            stacked: true,
            title: {
              display: true,
              text: 'Points S&P 500'
            }
          }
        }
      }
    });
  }

  document.getElementById('yearSelect').addEventListener('change', e => {
    displayTable(e.target.value);
  });
</script>
</body>
</html>
